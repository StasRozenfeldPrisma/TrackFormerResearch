REM Windows 10
REM Using python 3.7 (to support numpy 1.18.5)
REM cmd -> run as administrator

cd C:\Users\stas.rozenfeld\virtualenvs\p37_trackFormerResearch
"C:\Program Files\Python37\python.exe" -m venv C:\Users\stas.rozenfeld\virtualenvs\p37_trackFormerResearch
Scripts\activate
D:
cd D:\GIT_ripos\TrackFormerResearch
python -m pip install --upgrade pip
pip install -U pip setuptools wheel

REM comment out lap, numpy and Cython in the requirements.py
pip install numpy==1.21.6 Cython==0.29.20
pip install lap==0.4.0
pip install --no-deps -r requirements.txt

# torch==1.5.0, torchvision==0.6.0 for cuda 9.2
pip install torch==1.5.0+cu101 torchvision==0.6.0+cu101 -f https://download.pytorch.org/whl/torch_stable.html

pip install -U pip setuptools wheel "cython<3.0" "numpy==1.21.6"
pip install "git+https://github.com/philferriere/cocoapi.git#subdirectory=PythonAPI"  REM gets pycocotools

python D:\GIT_ripos\TrackFormerResearch\models\ops\setup.py build --build-base=D:\GIT_ripos\TrackFormerResearch\models\ops\ install

REM -----------------------------------
REM Windows 10 --  !!!!! --------
REM Using python 3.10 (to be able to add installation of detr)
REM cmd -> run as administrator

C:
cd C:\Users\stas.rozenfeld\virtualenvs\p3_10_trackFormerResearch
"C:\Program Files\Python310\python.exe" -m venv C:\Users\stas.rozenfeld\virtualenvs\p3_10_trackFormerResearch
Scripts\activate
D:
cd D:\GIT_ripos\TrackFormerResearch
python -m pip install --upgrade pip
pip install -U pip setuptools wheel


pip install --no-deps -r requirements.txt
pip install pycocotools==2.0.10

pip install fonttools==4.22.0 setuptools-scm==4.0.0 lazy_loader==0.3 tomli==1.0.0 exceptiongroup==1.0.0 iniconfig==1.1.1

pip install -U pip "packaging>=23.2" setuptools wheel
pip install --no-cache-dir git+https://github.com/cocodataset/panopticapi.git

pip install torch==1.13.1+cu116 torchvision==0.14.1+cu116 torchaudio==0.13.1 --extra-index-url https://download.pytorch.org/whl/cu116

pip install protobuf==3.20.1

pip install onnxruntime-gpu==1.13.1 --extra-index-url https://aiinfra.pkgs.visualstudio.com/PublicPackages/_packaging/onnxruntime-cuda-11/pypi/simple/
pip install onnx==1.12


REM go to start menu and run "x64 Native Tools Command Prompt for VS" (it runs vcvars64.bat)

doskey nvcc="C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.6\bin\nvcc.exe" $*
call "%ProgramFiles(x86)%\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"
set TORCH_CUDA_ARCH_LIST=8.6
set DISTUTILS_USE_SDK=1


python src/trackformer/models/ops/setup.py build --build-base=src/trackformer/models/ops/ install

REM: Done with a C:LOT of warnings for building  MultiScaleDeformableAttention
pip install PyQt5==5.15.7

REM: in C:\Users\stas.rozenfeld\virtualenvs\p3_10_trackFormerResearch\Lib\site-packages\motmetrics\mot.py
REM: lines 178, 180 replace np.bool with bool

REM in C:\Users\stas.rozenfeld\virtualenvs\p3_10_trackFormerResearch\Lib\site-packages\motmetrics\distances.py
REM line 79 replace "dtype=np.float" with  "dtype=float"

REM in C:\Users\stas.rozenfeld\virtualenvs\p3_10_trackFormerResearch\Lib\site-packages\pycocotools\coco.py
REM line 314. replace res.dataset['info'] = copy.deepcopy(self.dataset['info']) with:
REM if 'info' in self.dataset:
REM     res.dataset['info'] = copy.deepcopy(self.dataset['info'])

---------------------
-----------------------------
windows 10
p310 cuda 11.7 torch 1.13.1

C:
cd C:\Users\stas.rozenfeld\virtualenvs\p3_10_torch1.13.1_cu117_MultiScaleDefAttention
"C:\Program Files\Python310\python.exe" -m venv C:\Users\stas.rozenfeld\virtualenvs\p3_10_torch1.13.1_cu117_MultiScaleDefAttention
Scripts\activate
python -m pip install --upgrade pip
pip install -U pip setuptools wheel
pip install torch==1.13.0+cu117 torchvision==0.14.0+cu117 torchaudio==0.13.0 --extra-index-url https://download.pytorch.org/whl/cu117


REM go to start menu and run "x64 Native Tools Command Prompt for VS 2019" (it runs vcvars64.bat)
doskey nvcc="C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.7\bin\nvcc.exe" $*
call "%ProgramFiles(x86)%\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"
set TORCH_CUDA_ARCH_LIST=8.6
set DISTUTILS_USE_SDK=1

REM where cl
REM where nvcc
REM nvcc --version

D:
cd D:\GIT_ripos\TrackFormerResearch




set "CUDA_PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.7"
set "CUDA_HOME=%CUDA_PATH%"
set "CUDACXX=%CUDA_PATH%\bin\nvcc.exe"
set "PATH=%CUDA_PATH%\bin;%CUDA_PATH%\libnvvp;%PATH%"
REM Ampere RTX 30xx
set TORCH_CUDA_ARCH_LIST=8.6
REM Turing RTX 20xx: 7.5   | Pascal GTX 10xx: 6.1



python src/trackformer/models/ops/setup.py build --build-base=src/trackformer/models/ops/ install


-------------
fonttools==4.22.0
setuptools-scm==4.0.0
lazy_loader==0.3
tomli==1.0.0
exceptiongroup==1.0.0
iniconfig==1.1.1




pip install torch==1.13.1+cu116 torchvision==0.14.1+cu116 torchaudio==0.13.1 --extra-index-url https://download.pytorch.org/whl/cu116
pip install onnxruntime-gpu==1.13.1 --extra-index-url https://aiinfra.pkgs.visualstudio.com/PublicPackages/_packaging/onnxruntime-cuda-11/pypi/simple/
pip install onnx==1.12

pip install PyQt5==5.15.10
pip install einops==0.6.1
pip install einops-exts==0.0.4


--------------------------


"C:\Program Files\Python310\python.exe" -m venv C:\Users\stas.rozenfeld\virtualenvs\p3_10_torch1.13.1_cu117_MultiScaleDefAttention
Scripts\activate

python -m pip install --upgrade pip
pip install -U pip setuptools wheel

pip install torch==1.13.0+cu117 torchvision==0.14.0+cu117 torchaudio==0.13.0 --extra-index-url https://download.pytorch.org/whl/cu117

set "CUDA_PATH=C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.7"
set "CUDA_HOME=%CUDA_PATH%"
set "CUDACXX=%CUDA_PATH%\bin\nvcc.exe"
set "PATH=%CUDA_PATH%\bin;%CUDA_PATH%\libnvvp;%PATH%"
REM Ampere RTX 30xx
set TORCH_CUDA_ARCH_LIST=8.6
REM Turing RTX 20xx: 7.5   | Pascal GTX 10xx: 6.1







REM comment out lap, numpy, opencv-python and Cython in the requirements.py
python -m pip install numpy==1.26.4 Cython==3.1.2 opencv-python==4.10.0.84 pandas==2.3.1 pyyaml==6.0.2 scikit-image==0.22.0 scikit-learn==1.3.2 Pillow==9.0.1
pip install lap==0.5.12
pip install --no-deps -r requirements.txt

pip install -U "numpy==1.26.4" "Cython<3.0"
REM:  Cython-0.29.37
-------------
fonttools==4.22.0
setuptools-scm==4.0.0
lazy_loader==0.3
tomli==1.0.0
exceptiongroup==1.0.0
iniconfig==1.1.1





pytest 7.2.1 requires exceptiongroup>=1.0.0rc8; python_version < "3.11", which is not installed.
pytest 7.2.1 requires iniconfig, which is not installed.
exceptiongroup>=1.0.0rc8


lazy_loader>=0.3
 packaging>=21
scipy>=1.8
-----------

pip install git+https://github.com/cocodataset/panopticapi.git
pip install torch==1.13.1+cu116 torchvision==0.14.1+cu116 torchaudio==0.13.1 --extra-index-url https://download.pytorch.org/whl/cu116
pip install onnxruntime-gpu==1.13.1 --extra-index-url https://aiinfra.pkgs.visualstudio.com/PublicPackages/_packaging/onnxruntime-cuda-11/pypi/simple/
pip install onnx==1.12
REM: Note. onnx==1.12 installation removed protobuf-6.31.1 and installed protobuf-3.20.1 instead
pip install PyQt5==5.15.10
pip install einops==0.6.1
pip install einops-exts==0.0.4

# add: lapsolver,
# matplotlib, pyzmq, typed-ast